{"version":3,"names":[],"mappings":"","sources":["client.js"],"sourcesContent":["!function s(o,l,c){function a(t,e){if(!l[t]){if(!o[t]){var n=\"function\"==typeof require&&require;if(!e&&n)return n(t,!0);if(h)return h(t,!0);var r=new Error(\"Cannot find module '\"+t+\"'\");throw r.code=\"MODULE_NOT_FOUND\",r}var i=l[t]={exports:{}};o[t][0].call(i.exports,function(e){return a(o[t][1][e]||e)},i,i.exports,s,o,l,c)}return l[t].exports}for(var h=\"function\"==typeof require&&require,e=0;e<c.length;e++)a(c[e]);return a}({1:[function(e,r,s){(function(i){!function(h){var u=Array.isArray?Array.isArray:function(e){return\"[object Array]\"===Object.prototype.toString.call(e)},t=10;function a(){this._events={},this._conf&&n.call(this,this._conf)}function n(e){e?((this._conf=e).delimiter&&(this.delimiter=e.delimiter),this._maxListeners=e.maxListeners!==h?e.maxListeners:t,e.wildcard&&(this.wildcard=e.wildcard),e.newListener&&(this._newListener=e.newListener),e.removeListener&&(this._removeListener=e.removeListener),e.verboseMemoryLeak&&(this.verboseMemoryLeak=e.verboseMemoryLeak),this.wildcard&&(this.listenerTree={})):this._maxListeners=t}function o(e,t){var n=\"(node) warning: possible EventEmitter memory leak detected. \"+e+\" listeners added. Use emitter.setMaxListeners() to increase limit.\";if(this.verboseMemoryLeak&&(n+=\" Event name: \"+t+\".\"),void 0!==i&&i.emitWarning){var r=new Error(n);r.name=\"MaxListenersExceededWarning\",r.emitter=this,r.count=e,i.emitWarning(r)}else console.error(n),console.trace&&console.trace()}function e(e){this._events={},this._newListener=!1,this._removeListener=!1,this.verboseMemoryLeak=!1,n.call(this,e)}function _(e,t,n,r){if(!n)return[];var i,s,o,l,c,a,h,u=[],f=t.length,p=t[r],d=t[r+1];if(r===f&&n._listeners){if(\"function\"==typeof n._listeners)return e&&e.push(n._listeners),[n];for(i=0,s=n._listeners.length;i<s;i++)e&&e.push(n._listeners[i]);return[n]}if(\"*\"===p||\"**\"===p||n[p]){if(\"*\"===p){for(o in n)\"_listeners\"!==o&&n.hasOwnProperty(o)&&(u=u.concat(_(e,t,n[o],r+1)));return u}if(\"**\"===p){for(o in(h=r+1===f||r+2===f&&\"*\"===d)&&n._listeners&&(u=u.concat(_(e,t,n,f))),n)\"_listeners\"!==o&&n.hasOwnProperty(o)&&(\"*\"===o||\"**\"===o?(n[o]._listeners&&!h&&(u=u.concat(_(e,t,n[o],f))),u=u.concat(_(e,t,n[o],r))):u=o===d?u.concat(_(e,t,n[o],r+2)):u.concat(_(e,t,n[o],r)));return u}u=u.concat(_(e,t,n[p],r+1))}if((l=n[\"*\"])&&_(e,t,l,r+1),c=n[\"**\"])if(r<f)for(o in c._listeners&&_(e,t,c,f),c)\"_listeners\"!==o&&c.hasOwnProperty(o)&&(o===d?_(e,t,c[o],r+2):o===p?_(e,t,c[o],r+1):((a={})[o]=c[o],_(e,t,{\"**\":a},r+1)));else c._listeners?_(e,t,c,f):c[\"*\"]&&c[\"*\"]._listeners&&_(e,t,c[\"*\"],f);return u}(e.EventEmitter2=e).prototype.delimiter=\".\",e.prototype.setMaxListeners=function(e){e!==h&&(this._maxListeners=e,this._conf||(this._conf={}),this._conf.maxListeners=e)},e.prototype.event=\"\",e.prototype.once=function(e,t){return this._once(e,t,!1)},e.prototype.prependOnceListener=function(e,t){return this._once(e,t,!0)},e.prototype._once=function(e,t,n){return this._many(e,1,t,n),this},e.prototype.many=function(e,t,n){return this._many(e,t,n,!1)},e.prototype.prependMany=function(e,t,n){return this._many(e,t,n,!0)},e.prototype._many=function(e,t,n,r){var i=this;if(\"function\"!=typeof n)throw new Error(\"many only accepts instances of Function\");function s(){return 0==--t&&i.off(e,s),n.apply(this,arguments)}return s._origin=n,this._on(e,s,r),i},e.prototype.emit=function(){this._events||a.call(this);var e=arguments[0];if(\"newListener\"===e&&!this._newListener&&!this._events.newListener)return!1;var t,n,r,i,s,o=arguments.length;if(this._all&&this._all.length){if(s=this._all.slice(),3<o)for(t=new Array(o),i=0;i<o;i++)t[i]=arguments[i];for(r=0,n=s.length;r<n;r++)switch(this.event=e,o){case 1:s[r].call(this,e);break;case 2:s[r].call(this,e,arguments[1]);break;case 3:s[r].call(this,e,arguments[1],arguments[2]);break;default:s[r].apply(this,t)}}if(this.wildcard){s=[];var l=\"string\"==typeof e?e.split(this.delimiter):e.slice();_.call(this,s,l,this.listenerTree,0)}else{if(\"function\"==typeof(s=this._events[e])){switch(this.event=e,o){case 1:s.call(this);break;case 2:s.call(this,arguments[1]);break;case 3:s.call(this,arguments[1],arguments[2]);break;default:for(t=new Array(o-1),i=1;i<o;i++)t[i-1]=arguments[i];s.apply(this,t)}return!0}s&&(s=s.slice())}if(s&&s.length){if(3<o)for(t=new Array(o-1),i=1;i<o;i++)t[i-1]=arguments[i];for(r=0,n=s.length;r<n;r++)switch(this.event=e,o){case 1:s[r].call(this);break;case 2:s[r].call(this,arguments[1]);break;case 3:s[r].call(this,arguments[1],arguments[2]);break;default:s[r].apply(this,t)}return!0}if(!this._all&&\"error\"===e)throw arguments[1]instanceof Error?arguments[1]:new Error(\"Uncaught, unspecified 'error' event.\");return!!this._all},e.prototype.emitAsync=function(){this._events||a.call(this);var e=arguments[0];if(\"newListener\"===e&&!this._newListener&&!this._events.newListener)return Promise.resolve([!1]);var t,n,r,i,s,o=[],l=arguments.length;if(this._all){if(3<l)for(t=new Array(l),i=1;i<l;i++)t[i]=arguments[i];for(r=0,n=this._all.length;r<n;r++)switch(this.event=e,l){case 1:o.push(this._all[r].call(this,e));break;case 2:o.push(this._all[r].call(this,e,arguments[1]));break;case 3:o.push(this._all[r].call(this,e,arguments[1],arguments[2]));break;default:o.push(this._all[r].apply(this,t))}}if(this.wildcard){s=[];var c=\"string\"==typeof e?e.split(this.delimiter):e.slice();_.call(this,s,c,this.listenerTree,0)}else s=this._events[e];if(\"function\"==typeof s)switch(this.event=e,l){case 1:o.push(s.call(this));break;case 2:o.push(s.call(this,arguments[1]));break;case 3:o.push(s.call(this,arguments[1],arguments[2]));break;default:for(t=new Array(l-1),i=1;i<l;i++)t[i-1]=arguments[i];o.push(s.apply(this,t))}else if(s&&s.length){if(s=s.slice(),3<l)for(t=new Array(l-1),i=1;i<l;i++)t[i-1]=arguments[i];for(r=0,n=s.length;r<n;r++)switch(this.event=e,l){case 1:o.push(s[r].call(this));break;case 2:o.push(s[r].call(this,arguments[1]));break;case 3:o.push(s[r].call(this,arguments[1],arguments[2]));break;default:o.push(s[r].apply(this,t))}}else if(!this._all&&\"error\"===e)return arguments[1]instanceof Error?Promise.reject(arguments[1]):Promise.reject(\"Uncaught, unspecified 'error' event.\");return Promise.all(o)},e.prototype.on=function(e,t){return this._on(e,t,!1)},e.prototype.prependListener=function(e,t){return this._on(e,t,!0)},e.prototype.onAny=function(e){return this._onAny(e,!1)},e.prototype.prependAny=function(e){return this._onAny(e,!0)},e.prototype.addListener=e.prototype.on,e.prototype._onAny=function(e,t){if(\"function\"!=typeof e)throw new Error(\"onAny only accepts instances of Function\");return this._all||(this._all=[]),t?this._all.unshift(e):this._all.push(e),this},e.prototype._on=function(e,t,n){if(\"function\"==typeof e)return this._onAny(e,t),this;if(\"function\"!=typeof t)throw new Error(\"on only accepts instances of Function\");return this._events||a.call(this),this._newListener&&this.emit(\"newListener\",e,t),this.wildcard?function(e,t){for(var n=0,r=(e=\"string\"==typeof e?e.split(this.delimiter):e.slice()).length;n+1<r;n++)if(\"**\"===e[n]&&\"**\"===e[n+1])return;for(var i=this.listenerTree,s=e.shift();s!==h;){if(i[s]||(i[s]={}),i=i[s],0===e.length)return i._listeners?(\"function\"==typeof i._listeners&&(i._listeners=[i._listeners]),i._listeners.push(t),!i._listeners.warned&&0<this._maxListeners&&i._listeners.length>this._maxListeners&&(i._listeners.warned=!0,o.call(this,i._listeners.length,s))):i._listeners=t,!0;s=e.shift()}return!0}.call(this,e,t):this._events[e]?(\"function\"==typeof this._events[e]&&(this._events[e]=[this._events[e]]),n?this._events[e].unshift(t):this._events[e].push(t),!this._events[e].warned&&0<this._maxListeners&&this._events[e].length>this._maxListeners&&(this._events[e].warned=!0,o.call(this,this._events[e].length,e))):this._events[e]=t,this},e.prototype.off=function(e,t){if(\"function\"!=typeof t)throw new Error(\"removeListener only takes instances of Function\");var n,r=[];if(this.wildcard){var i=\"string\"==typeof e?e.split(this.delimiter):e.slice();r=_.call(this,null,i,this.listenerTree,0)}else{if(!this._events[e])return this;n=this._events[e],r.push({_listeners:n})}for(var s=0;s<r.length;s++){var o=r[s];if(n=o._listeners,u(n)){for(var l=-1,c=0,a=n.length;c<a;c++)if(n[c]===t||n[c].listener&&n[c].listener===t||n[c]._origin&&n[c]._origin===t){l=c;break}if(l<0)continue;return this.wildcard?o._listeners.splice(l,1):this._events[e].splice(l,1),0===n.length&&(this.wildcard?delete o._listeners:delete this._events[e]),this._removeListener&&this.emit(\"removeListener\",e,t),this}(n===t||n.listener&&n.listener===t||n._origin&&n._origin===t)&&(this.wildcard?delete o._listeners:delete this._events[e],this._removeListener&&this.emit(\"removeListener\",e,t))}return function e(t){if(t!==h){var n=Object.keys(t);for(var r in n){var i=n[r],s=t[i];s instanceof Function||\"object\"!=typeof s||null===s||(0<Object.keys(s).length&&e(t[i]),0===Object.keys(s).length&&delete t[i])}}}(this.listenerTree),this},e.prototype.offAny=function(e){var t,n=0,r=0;if(e&&this._all&&0<this._all.length){for(n=0,r=(t=this._all).length;n<r;n++)if(e===t[n])return t.splice(n,1),this._removeListener&&this.emit(\"removeListenerAny\",e),this}else{if(t=this._all,this._removeListener)for(n=0,r=t.length;n<r;n++)this.emit(\"removeListenerAny\",t[n]);this._all=[]}return this},e.prototype.removeListener=e.prototype.off,e.prototype.removeAllListeners=function(e){if(e===h)return!this._events||a.call(this),this;if(this.wildcard)for(var t=\"string\"==typeof e?e.split(this.delimiter):e.slice(),n=_.call(this,null,t,this.listenerTree,0),r=0;r<n.length;r++){n[r]._listeners=null}else this._events&&(this._events[e]=null);return this},e.prototype.listeners=function(e){if(this.wildcard){var t=[],n=\"string\"==typeof e?e.split(this.delimiter):e.slice();return _.call(this,t,n,this.listenerTree,0),t}return this._events||a.call(this),this._events[e]||(this._events[e]=[]),u(this._events[e])||(this._events[e]=[this._events[e]]),this._events[e]},e.prototype.eventNames=function(){return Object.keys(this._events)},e.prototype.listenerCount=function(e){return this.listeners(e).length},e.prototype.listenersAny=function(){return this._all?this._all:[]},\"function\"==typeof define&&define.amd?define(function(){return e}):\"object\"==typeof s?r.exports=e:window.EventEmitter2=e}()}).call(this,e(\"_process\"))},{_process:2}],2:[function(e,t,n){var r,i,s=t.exports={};function o(){throw new Error(\"setTimeout has not been defined\")}function l(){throw new Error(\"clearTimeout has not been defined\")}function c(t){if(r===setTimeout)return setTimeout(t,0);if((r===o||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}!function(){try{r=\"function\"==typeof setTimeout?setTimeout:o}catch(e){r=o}try{i=\"function\"==typeof clearTimeout?clearTimeout:l}catch(e){i=l}}();var a,h=[],u=!1,f=-1;function p(){u&&a&&(u=!1,a.length?h=a.concat(h):f=-1,h.length&&d())}function d(){if(!u){var e=c(p);u=!0;for(var t=h.length;t;){for(a=h,h=[];++f<t;)a&&a[f].run();f=-1,t=h.length}a=null,u=!1,function(t){if(i===clearTimeout)return clearTimeout(t);if((i===l||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(t);try{i(t)}catch(e){try{return i.call(null,t)}catch(e){return i.call(this,t)}}}(e)}}function _(e,t){this.fun=e,this.array=t}function v(){}s.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];h.push(new _(e,t)),1!==h.length||u||c(d)},_.prototype.run=function(){this.fun.apply(null,this.array)},s.title=\"browser\",s.browser=!0,s.env={},s.argv=[],s.version=\"\",s.versions={},s.on=v,s.addListener=v,s.once=v,s.off=v,s.removeListener=v,s.removeAllListeners=v,s.emit=v,s.prependListener=v,s.prependOnceListener=v,s.listeners=function(e){return[]},s.binding=function(e){throw new Error(\"process.binding is not supported\")},s.cwd=function(){return\"/\"},s.chdir=function(e){throw new Error(\"process.chdir is not supported\")},s.umask=function(){return 0}},{}],3:[function(e,t,n){\"use strict\";e(\"./ee\");var r={currentDir:\"\"};t.exports={get:function(){return r.currentDir},set:function(e){r.currentDir!==e&&console.log(\"dir changed\",r.currentDir,\"=>\",e),r.currentDir=e}}},{\"./ee\":4}],4:[function(e,t,n){\"use strict\";Object.defineProperty(n,\"__esModule\",{value:!0});var r=new(e(\"eventemitter2\").EventEmitter2);n.default=r},{eventemitter2:1}],5:[function(e,t,n){\"use strict\";Object.defineProperty(n,\"__esModule\",{value:!0});var r={border:\"1px solid #eee\",\"box-sizing\":\"border-box\",position:\"absolute\",top:0,bottom:0,right:0,width:n.IFRAME_WIDTH=\"40%\",height:\"100%\"},i=n.iframe=document.createElement(\"iframe\");Object.keys(r).forEach(function(e){i.style[e]=r[e]});var s=n.setSource=function(e){return i.src=e};n.getSource=function(){return i.src},n.setError=function(e){var t='<div style=\"padding:20px\"><h1>Too Bad</h1><p>'+encodeURIComponent(e)+'</p><img style=\"max-width:200px;margin 0 auto;display:block\" src=\"https://bhubr.github.io/img/grumpy-cat.jpg\" alt=\"grumpy cat\" /></div>',n=\"data:text/html;charset=UTF-8,\"+t;i.src!==n&&s(\"data:text/html;charset=UTF-8,\"+t)}},{}],6:[function(e,t,n){\"use strict\";var r=e(\"./iframe\"),i=e(\"./ws\"),s=l(e(\"./ee\")),o=l(e(\"./currentDir\"));function l(e){return e&&e.__esModule?e:{default:e}}document.addEventListener(\"DOMContentLoaded\",function(){document.body.style.marginRight=r.IFRAME_WIDTH,document.body.appendChild(r.iframe),s.default.on(\"dir:changed\",function(e){e!==o.default.get()&&(console.log(\"react to dir change\",e),o.default.set(e),(0,r.setSource)(\"http://localhost:8000/\"+e))}),(0,i.connect)()})},{\"./currentDir\":3,\"./ee\":4,\"./iframe\":5,\"./ws\":7}],7:[function(e,t,n){\"use strict\";Object.defineProperty(n,\"__esModule\",{value:!0}),n.connect=void 0;var r=e(\"./iframe\"),i=o(e(\"./ee\")),s=o(e(\"./currentDir\"));function o(e){return e&&e.__esModule?e:{default:e}}var l=\"Le serveur Express dans <code>react-app-tdd/express</code> doit être lancé avec <code>node server.js</code>.\",c={interval:-1,client:null},a=function(){-1===c.interval&&(c.interval=setInterval(d,1e3))},h=function(){(0,r.setSource)(\"http://localhost:8000\"),-1!==c.interval&&(clearInterval(c.interval),c.interval=-1)},u=function(){(0,r.setError)(l),c.client=null,a()},f=function(){(0,r.setError)(l),s.default.set(\"\"),c.client=null,a()},p=function(e){var t=void 0;if(\"string\"==typeof e.data){try{t=JSON.parse(e.data)}catch(e){console.log(\"not json\",e)}t.type&&i.default.emit(t.type,t.data)}},d=n.connect=function(){var e=c.client=new WebSocket(\"ws://localhost:8000/\",\"echo-protocol\");e.onerror=u,e.onopen=h,e.onclose=f,e.onmessage=p}},{\"./currentDir\":3,\"./ee\":4,\"./iframe\":5}]},{},[6]);"],"file":"client.js"}